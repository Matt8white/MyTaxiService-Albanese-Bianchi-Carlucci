\pagebreak
\section{Specific requirements}

\subsection{External interfaces}

% qui vanno i mock up, sia app mobile, sia web
% registrazione user
% prenotazione taxi (con possibilita' sharing)
% riepilogo dati
% disponibilita' tassista (solo app)

% Counter Goals
\newcounter{FunReqG}
% Counter Requirements, si resetta quando cambia quello dei goal
\newcounter{FunReqR}[FunReqG]
% Counter Dom. Assumptions, si resetta quando cambia quello dei goal
\newcounter{FunReqD}[FunReqG]

% --- TUTORIAL SU COME FARE GOALS ---
% \begin{Goal}{etichetta_x_refs}{Titolo}{
%     \Req{...}
%     \Dom{...}
% }
% \end{Goal}
% --- END TUTORIAL ---
%

% creo l'environment goal
\newenvironment{Goal}[2]{
    \refstepcounter{FunReqG}
    \paragraph{Goal \arabic{FunReqG}:} #2.
    \label{goal:#1}
    \begin{itemize}
}{\end{itemize}}

\newcommand{\Req}[1]{
    \stepcounter{FunReqR}
    \item[] \textbf{Requirement \arabic{FunReqR}}: #1.
}

\newcommand{\Dom}[1]{
    \stepcounter{FunReqD}
    \item[] \textbf{Domain Assumption \arabic{FunReqD}}: #1.
}

\subsection{Functional Requirements}

\begin{Goal}{register}{Allow guests to register to the platform}{
    \Req{The guest must not be already registrated}
    \Req{Guests cannot access services offered by the platform before being registered or logged in}
    \Req{The email used for registration mush not be already used by another user}
    \Req{The user must insert valid informations such as email and phone number}
}
\end{Goal}

\begin{Goal}{login}{Allow users to access the platform by logging in}{
    \Req{The user must not be already logged in}
    \Req{The user must insert correct credentials to properly access}
}
\end{Goal}
	
\begin{Goal}{queue}{Guarantee a fair management of the zone queues}{
    \Req{The taxi driver on top of the queue must receive a notification when a request comes} 
    \Req{Taxi drivers must positively answer to the notification in 30 seconds}
    \Dom{There is always a taxi driver in every queue}
    \Dom{A driver in queue is available to accept a ride}
}
\end{Goal}
%????
% \subsubsection{[G3] A driver who misses or refuses a call is removed from the queue and reinserted at the bottom of it.}
% 	\begin{enumerate}
% 	\item \textbf [R1] ??
% 	\end{enumerate}
%????	

\begin{Goal}{availability}{Allow taxi drivers to indicate their availability}{
    \Req{Drivers has to press a specified button on their app}
}
\end{Goal}

\begin{Goal}{zone}{Guarantee presence of taxi drivers in every zone}{
    \Req{A minimum number of taxi drivers, equal to the number of zones must be available}
    \Dom{The number of drivers is greater than the number of zones}
}
\end{Goal}
	
\begin{Goal}{api}{Allow developers to add functionalities to the system}{
    \Req{The system must provide APIs}
    \Req{These APIs must allow to run programmatically all and only what can be done by web or smartphone}
    \Req{The system must check that every command submitted by APIs could be run at that user's level of privileges}
}
\end{Goal}
	
\begin{Goal}{call}{Allow customers the possibility to immediately call for a taxi}{
    \Req{When a customer calls for a taxi using his app the system must deliver a request to the first taxi driver in the customer's zone queue}
    \Dom{TODO}
}
\end{Goal}

\begin{Goal}{reserve}{Allow customers to reserve a taxi for a given date and time}{
    \Req{TODO}
    \Dom{TODO}
}
\end{Goal}

\begin{Goal}{share}{Allow customers the possibility to share a ride}{
    \Req{TODO}
    \Dom{TODO}
}
\end{Goal}

\begin{Goal}{info}{Allow customers to receive informations about their reservation or call}{
    \Req{TODO}
    \Dom{TODO}
}
\end{Goal}

\begin{Goal}{payment}{Allow different types of payment}{
    \Req{TODO}
    \Dom{TODO}
}
\end{Goal}

% -- TUTORIAL REFS+LABEL --
% Il goal \ref{goal:info} si trova a pagina \pageref{goal:info}
% -- END TUTORIAL --

% --------OLD ---------------
%functional requirements
%  1) garantire l'accesso agli utenti
%  2) una richiesta viene gestita dal tassista che e' da piu' tempo in coda
%     Assumption: c'e' sempre qualcuno in coda, se  e' in coda e' disponibile,
%     Requirement: il primo tassista in coda riceve una notifica quando c'e'
%                  una richiesta di taxi e risponde alla notifica 
%                  positivamente entro 30 secondi.
%
%  3) se un tassista non risponde, viene reimmesso in fondo alla coda per un numero limitato di volte
%  4) permettere al tassista di indicare la propria disponibilita'
%  5) garantire la presenza di taxi in ogni zona
%  6) fare le API
%  7) garantire possibilita' di prenotazione taxi per il momento
%  8) possibilita' riservare taxi a una data/ora con src/dest
%  9) garantire condivisione di un taxi
% 10) tenere aggiornato l'utente sullo stato delle prenotazioni
% 11) garantire piu' possibilita' di pagamento
% -------- END OLD ---------------
\subsection{Performance requirements}
\subsection{Logical database Requirement}

% --- TUTORIAL SCENARIOS --- 
% \scenario{etichetta}{titolo}{testo}
% --- END TUTORIAL ---

\pagebreak
\subsection{Scenarios}
\scenario{michael}{A shy student}{Michael does not want to lose his favorite class, but unfortunately a strike has been announced for today. Since he lives not too far nor too near from his university, he decides to take a taxi; unfortunately, his shyness does not let him call for one. So he decides to use MyTaxiService, the application developed by his own city, in order to get a cab as soon as possible. As a registered user, the only thing he has to do is open the app, log in, click on the “Get a taxi now” button and just wait for the response to come.}

\scenario{siegfried}{The german IT entrepreneur}{Siegfried is a German IT entrepreneur who has just arrived to the city for a working meeting. Since he does not trust the public transport service, he wants to rely on the taxi service. After a quick search on Google, he finds myTaxiService and decides to download the app. After filling in his own personal data, including the cell phone number, he clicks on the Submit button; after few seconds, he receives an email with a link so that he can confirm his registration and start using the service.}
%(SMS??)

\scenario{norma}{Taxi reservation}{Norma has to fly to Denmark the next day early in the morning. Due to this, she cannot take any public transportation service. Being a very organized woman, she decides to reserve a taxi the night before. Since she has very little time, she wants a friendly and fast way to do so; she decides then to use the “Reseve a taxi” functionality provided by myTaxiService web app on her laptop. The only things she has to insert are her starting point, her destination and when to leave. After that, a confirmation message is given and a taxi is successfully reserved.}

\scenario{riccardo}{The amusement park lover}{Riccardo loves amusement parks and so he decides to organize a full day in the nearest one. He knows that the trains and busses will be pretty unusable; since he wants to spend as much as possible on his entertainment, he decides to reserve a taxi the night before by using the Sharing option. Luke and Christine decide to do the same too and find out that Riccardo had already reserved a vehicle for the same date and the same starting point. They accept to take the same taxi and equally divide the fees.}

\scenario{max}{The taxi driver}{Max is a driver working for the public taxi service of his own city. During his daytime turn, he gets a request for a ride from a man nearby; Max accepts since the application has not notified anything at the moment. During the ride a request comes from the system, but Max refuses to accept it by clicking on the “Decline Request” button. The system puts the driver in his zone queue tail}

% --- TUTORIAL USECASE --- 
% \usecase{Name}{Description}{PrimaryActor}{BasicFlow}{AlternateFlow}
% --- END TUTORIAL ---
\pagebreak
\subsection{Use cases and UML diagrams}
INSERT DIAGRAM HERE
\includegraphics[scale=0.5]{wip.png}
\pagebreak

% ---------- SIGN UP --------------------
\usecase
{Sign Up}
{Registration to the system by a customer-to-be.}
{Guest}
{
\begin{enumerate}
	\item Guests visit the service home page
	\item The guest clicks on "Register"
	\item The system outputs the form on screen
	\item The guest inserts his name, mail, password and mobile phone number and then clicks on "Continue"
	\item The system checks if the mail, password and phone number are valid; if so, it sends a mail and a sms with a verification link
	\item The guest clicks on the link and verifies his account
	\item The guest is now a customer registered to the service. 
\end{enumerate}
}
{
\begin{enumerate}
	\item The guest is already registered
	\item One or more fields are not well-formed
	\item Username already in use
    \item The validation link is not more valid (after 48 hours)
\end{enumerate}
}
{ TODO }

% SEQUENCE 
\pagebreak
\includegraphics[scale=0.5]{wip.png}

% ---------- SIGN IN --------------------
\usecase
{Sign in}
{Login by a customer}
{Guest, Customer}
{
\begin{enumerate}
	\item A guest visits the service home page
	\item The guest clicks on "Log in"
	\item The system outputs the form on screen
	\item The guest inserts his name, password then clicks on "Continue"
	\item The system checks if the mail, password and phone number are valid and present in the DB
	\item The guest is redirected to the home page and recognized as a customer from now on.
\end{enumerate}
}
{
\begin{enumerate}
	\item The user and/or password are incorrect
	\item One or more fields are not well-formed
	\item Username not registered
\end{enumerate}
}
{ TODO }

% SEQUENCE 
\pagebreak
\includegraphics[scale=0.5]{wip.png}

% ---------- RESERVATION --------------------
\usecase
{Reserve a taxi}
{Reservation of a taxi by a customer for a specified date, start and destination}
{Customer, Taxi Handler}
{
\begin{enumerate}
	\item The customer clicks on "Reserve a taxi"
	\item The system shows the reservation page
	\item The customer fills in the mandatory information (starting point, destination and date-time)
	\item The TaxiHandler registers the request and evaluate it when needed (see "Allocate a taxi" use case)
	\item The customer is informed that the operation did not fail thanks to a confirmation screen
\end{enumerate}
}
{
\textbf{Sharing option}
\begin{enumerate}
	\item Same operations as before till point 3
	\item The user also specifies that he wants to share his taxi
	\item The TaxiHandler assigns the customer to the first reserved taxi for that ride if present
	\item If there are no available shared rides, a new one is created on the spot
	\item Same operation as before from point 4 on
\end{enumerate}
}
{ TODO }

% SEQUENCE 
\pagebreak
\includegraphics[scale=0.5]{wip.png}
